import json
from tqdm import tqdm
from glob import glob
from itertools import combinations

import shutil

no_belt = [
'20230619_101844',
'20230619_103633',
'20230619_103724',
'20230619_103811',
'20230619_103910',
'20230619_104023',
'20230619_104042',
'20230619_104126',
'20230619_104809',
'20230619_104838',
'20230619_104915',
'20230619_105052',
'20230619_105155',
'20230619_105214',
'20230619_105248',
'20230619_110021',
'20230619_111942',
'20230619_112036',
'20230619_112134',
'20230619_112249',
'20230619_112312',
'20230619_112400',
'20230619_112951',
'20230619_113022',
'20230619_113131',
'20230619_113236',
'20230619_113348',
'20230619_113410',
'20230619_113447',
'20230619_011747',
'20230619_011833',
'20230619_011946',
'20230619_012100',
'20230619_012236',
'20230619_012300',
'20230619_012415',
'20230619_012635',
'20230619_014135',
'20230619_014210',
'20230619_014247',
'20230619_014327',
'20230619_014609',
'20230619_014727',
'20230619_014809',
'20230619_022300',
'20230619_022338',
'20230619_022410',
'20230619_022452',
'20230619_022639',
'20230619_022800',
'20230619_022844',
'20230619_023946',
'20230619_024021',
'20230619_024135',
'20230619_024236',
'20230619_024318',
'20230619_024433',
'20230619_024511',
'20230620_104141',
'20230620_104241',
'20230620_104339',
'20230620_104447',
'20230620_104606',
'20230620_104650',
'20230620_104725',
'20230620_105558',
'20230620_105644',
'20230620_105736',
'20230620_105829',
'20230620_105929',
'20230620_110045',
'20230620_110120',
'20230620_112509',
'20230620_112617',
'20230620_112723',
'20230620_112842',
'20230620_113027',
'20230620_113124',
'20230620_113211',
'20230620_113241',
'20230620_113837',
'20230620_113917',
'20230620_114009',
'20230620_114101',
'20230620_114152',
'20230620_114320',
'20230620_114345',
'20230620_012756',
'20230620_012908',
'20230620_013110',
'20230620_013156',
'20230620_013254',
'20230620_013337',
'20230620_013407',
'20230620_020038',
'20230620_020134',
'20230620_020157',
'20230620_020247',
'20230620_020427',
'20230620_020514',
'20230620_020540',
'20230620_020600',
'20230620_021139',
'20230620_022247',
'20230620_023029',
'20230620_023100',
'20230620_023150',
'20230620_023235',
'20230620_023324',
'20230620_023404',
'20230620_023426',
'20230620_025116',
'20230620_025144',
'20230620_025225',
'20230620_025304',
'20230620_025354',
'20230620_025428',
'20230620_025450',
'20230621_111241',
'20230621_111355',
'20230621_111528',
'20230621_111629',
'20230621_111725',
'20230621_111805',
'20230621_111832',
'20230621_112549',
'20230621_112632',
'20230621_112711',
'20230621_112802',
'20230621_112852',
'20230621_112941',
'20230621_113008',
'20230621_114022',
'20230621_114140',
'20230621_114221',
'20230621_114316',
'20230621_114401',
'20230621_114456',
'20230621_114507',
'20230621_114552',
'20230621_114619',
'20230621_115227',
'20230621_115257',
'20230621_115331',
'20230621_115429',
'20230621_115520',
'20230621_115600',
'20230621_115627',
'20230621_014329',
'20230621_014411',
'20230621_014510',
'20230621_014606',
'20230621_014651',
'20230621_014749',
'20230621_014840',
'20230621_014906',
'20230621_015450',
'20230621_015526',
'20230621_015600',
'20230621_015647',
'20230621_015738',
'20230621_015813',
'20230621_015839',
'20230621_021630',
'20230621_021718',
'20230621_021822',
'20230621_021907',
'20230621_021956',
'20230621_022012',
'20230621_022038',
'20230621_022544',
'20230621_022612',
'20230621_022648',
'20230621_022733',
'20230621_022821',
'20230621_022846',
'20230621_022914',
'20230705_085958',
'20230705_090108',
'20230705_090356',
'20230705_090518',
'20230705_090743',
'20230705_090810',
'20230705_090858',
'20230705_091735',
'20230705_091821',
'20230705_091909',
'20230705_092025',
'20230705_092155',
'20230705_092216',
'20230705_092302',
'20230705_093224',
'20230705_093339',
'20230705_094402',
'20230705_094508',
'20230705_094657',
'20230705_094823',
'20230705_094846',
'20230705_094936',
'20230705_095647',
'20230705_095724',
'20230705_095822',
'20230705_095925',
'20230705_100040',
'20230705_100102',
'20230705_100140',
'20230705_102210',
'20230705_102238',
'20230705_102317',
'20230705_102358',
'20230705_102503',
'20230705_102622',
'20230705_102647',
'20230705_102728',
'20230705_103420',
'20230705_103503',
'20230705_103552',
'20230705_103845',
'20230705_104001',
'20230705_104024',
'20230705_104104',
'20230705_110940',
'20230705_111014',
'20230705_111053',
'20230705_111155',
'20230705_111317',
'20230705_111335',
'20230705_111417',
'20230705_112059',
'20230705_112131',
'20230705_112352',
'20230705_112458',
'20230705_112629',
'20230705_112648',
'20230705_112740',
'20230705_014501',
'20230705_014618',
'20230705_014800',
'20230705_014933',
'20230705_015219',
'20230705_015359',
'20230705_015430',
'20230705_015519',
'20230705_021203',
'20230705_021305',
'20230705_021414',
'20230705_021535',
'20230705_021701',
'20230705_021728',
'20230705_021838',
'20230705_022333',
'20230705_022505',
'20230705_022655',
'20230705_022806',
'20230705_022932',
'20230705_023122',
'20230705_023159',
'20230705_023248',
'20230705_024243',
'20230705_024355',
'20230705_024455',
'20230705_024714',
'20230705_024845',
'20230705_024912',
'20230705_025000',
'20230705_031750',
'20230705_031847',
'20230705_031947',
'20230705_032223',
'20230705_032352',
'20230705_032427',
'20230705_032509',
'20230705_033608',
'20230705_033701',
'20230705_033758',
'20230705_033920',
'20230705_034053',
'20230705_034221',
'20230705_034303',
'20230705_040901',
'20230705_040945',
'20230705_041043',
'20230705_041205',
'20230705_041344',
'20230705_041432',
'20230705_041518',
'20230705_042625',
'20230705_042729',
'20230705_042835',
'20230705_042953',
'20230705_043120',
'20230705_043211',
'20230705_043257',
'20230706_014124',
'20230706_014447',
'20230706_014535',
'20230706_014733',
'20230706_014849',
'20230706_014921',
'20230706_015006',
'20230706_015752',
'20230706_015836',
'20230706_015919',
'20230706_020345',
'20230706_020506',
'20230706_020528',
'20230706_020610',
'20230706_020659',
'20230706_022158',
'20230706_022247',
'20230706_022329',
'20230706_022420',
'20230706_022609',
'20230706_022720',
'20230706_022742',
'20230706_022823',
'20230706_023437',
'20230706_023600',
'20230706_023711',
'20230706_023813',
'20230706_023920',
'20230706_023941',
'20230706_024024',
'20230706_030337',
'20230706_030445',
'20230706_030537',
'20230706_030646',
'20230706_030757',
'20230706_030823',
'20230706_030904',
'20230706_032120',
'20230706_032351',
'20230706_032457',
'20230706_032606',
'20230706_032711',
'20230706_032737',
'20230706_032813',
'20230706_035413',
'20230706_035454',
'20230706_035551',
'20230706_035656',
'20230706_035805',
'20230706_035835',
'20230706_035913',
'20230706_040550',
'20230706_040627',
'20230706_040738',
'20230706_040841',
'20230706_041007',
'20230706_041041',
'20230706_041119',
'20230709_085222',
'20230709_085310',
'20230709_085602',
'20230709_085722',
'20230709_085841',
'20230709_085957',
'20230709_090028',
'20230709_090858',
'20230709_090933',
'20230709_091017',
'20230709_091108',
'20230709_091202',
'20230709_091218',
'20230709_091245',
'20230709_091818',
'20230709_091905',
'20230709_091953',
'20230709_092053',
'20230709_092137',
'20230709_092153',
'20230709_092214',
'20230709_092242',
'20230709_092906',
'20230709_092949',
'20230709_093022',
'20230709_093059',
'20230709_093147',
'20230709_093227',
'20230709_093251',
'20230709_100045',
'20230709_100113',
'20230709_100158',
'20230709_100224',
'20230709_100258',
'20230709_100406',
'20230709_100430',
'20230709_100946',
'20230709_101012',
'20230709_101042',
'20230709_101103',
'20230709_101127',
'20230709_101228',
'20230709_101247',
'20230709_102709',
'20230709_102730',
'20230709_102756',
'20230709_102820',
'20230709_102926',
'20230709_103018',
'20230709_103043',
'20230709_103504',
'20230709_103520',
'20230709_103541',
'20230709_103606',
'20230709_103631',
'20230709_103725',
'20230709_103751',
'20230710_084956',
'20230710_085029',
'20230710_085105',
'20230710_085247',
'20230710_085346',
'20230710_085404',
'20230710_085437',
'20230710_090038',
'20230710_090110',
'20230710_090147',
'20230710_090239',
'20230710_090342',
'20230710_090538',
'20230710_090639',
'20230710_090721',
'20230710_091508',
'20230710_091632',
'20230710_091718',
'20230710_091811',
'20230710_091914',
'20230710_091937',
'20230710_092012',
'20230710_092935',
'20230710_093004',
'20230710_093042',
'20230710_093131',
'20230710_093226',
'20230710_093246',
'20230710_093323',
'20230710_095430',
'20230710_095534',
'20230710_095653',
'20230710_095740',
'20230710_095818',
'20230710_095945',
'20230710_100018',
'20230710_100843',
'20230710_101005',
'20230710_101039',
'20230710_101104',
'20230710_101144',
'20230710_101324',
'20230710_101353',
'20230710_103148',
'20230710_103227',
'20230710_103311',
'20230710_103341',
'20230710_103657',
'20230710_103816',
'20230710_103848',
'20230710_104641',
'20230710_104719',
'20230710_104805',
'20230710_104839',
'20230710_104949',
'20230710_105104',
'20230710_105141',
'20230710_105222',
'20230711_015615',
'20230711_015705',
'20230711_015746',
'20230711_015841',
'20230711_015958',
'20230711_020018',
'20230711_020045',
'20230711_020718',
'20230711_020748',
'20230711_020819',
'20230711_020859',
'20230711_021008',
'20230711_021023',
'20230711_021051',
'20230711_021712',
'20230711_021840',
'20230711_021921',
'20230711_022014',
'20230711_022144',
'20230711_022204',
'20230711_022310',
'20230711_022855',
'20230711_022932',
'20230711_023007',
'20230711_023133',
'20230711_023245',
'20230711_023325',
'20230711_023429',
'20230711_024748',
'20230711_024824',
'20230711_024929',
'20230711_025014',
'20230711_025100',
'20230711_025220',
'20230711_025256',
'20230711_025406',
'20230711_025505',
'20230711_025650',
'20230711_025732',
'20230711_025834',
'20230711_025947',
'20230711_030016',
'20230712_085851',
'20230712_090052',
'20230712_090144',
'20230712_090322',
'20230712_090441',
'20230712_090508',
'20230712_090539',
'20230712_091329',
'20230712_091414',
'20230712_091506',
'20230712_091620',
'20230712_091718',
'20230712_091735',
'20230712_091802',
'20230712_093433',
'20230712_093454',
'20230712_093604',
'20230712_093648',
'20230712_093732',
'20230712_093829',
'20230712_093846',
'20230712_093909',
'20230712_094515',
'20230712_094554',
'20230712_094631',
'20230712_094713',
'20230712_094807',
'20230712_094841',
'20230712_094910',
'20230712_100848',
'20230712_100954',
'20230712_101146',
'20230712_101255',
'20230712_101334',
'20230712_101521',
'20230712_101602',
'20230712_101657',
'20230712_101736',
'20230712_101807',
'20230712_101831',
'20230712_101857',
'20230712_102024',
'20230712_102048',
'20230715_014110',
'20230715_014152',
'20230715_014251',
'20230715_014536',
'20230715_014638',
'20230715_014701',
'20230715_014756',
'20230715_015426',
'20230715_015502',
'20230715_015541',
'20230715_015634',
'20230715_015731',
'20230715_015748',
'20230715_015822',
'20230715_015903',
'20230715_020706',
'20230715_020754',
'20230715_020830',
'20230715_021034',
'20230715_021124',
'20230715_021214',
'20230715_021303',
'20230715_022531',
'20230715_022600',
'20230715_022630',
'20230715_022721',
'20230715_022811',
'20230715_022828',
'20230715_022855',
'20230715_025047',
'20230715_025121',
'20230715_025231',
'20230715_025313',
'20230715_025359',
'20230715_025501',
'20230715_025533',
'20230715_030637',
'20230715_030706',
'20230715_030736',
'20230715_030805',
'20230715_030832',
'20230715_030924',
'20230715_031015',
'20230716_021927',
'20230716_022018',
'20230716_022055',
'20230716_022149',
'20230716_022250',
'20230716_022311',
'20230716_022340',
'20230716_023002',
'20230716_023111',
'20230716_023141',
'20230716_023332',
'20230716_023437',
'20230716_023502',
'20230716_023533',
'20230716_025221',
'20230716_025303',
'20230716_025345',
'20230716_025426',
'20230716_025505',
'20230716_025637',
'20230716_025756',
'20230716_030826',
'20230716_030914',
'20230716_030956',
'20230716_031027',
'20230716_031112',
'20230716_031257',
'20230716_031356',
'20230717_084914',
'20230717_085006',
'20230717_085059',
'20230717_085256',
'20230717_085400',
'20230717_085421',
'20230717_085456',
'20230717_090233',
'20230717_090310',
'20230717_090349',
'20230717_090437',
'20230717_090540',
'20230717_090558',
'20230717_090628',
'20230717_090724',
'20230717_091722',
'20230717_091820',
'20230717_091934',
'20230717_092026',
'20230717_092133',
'20230717_092154',
'20230717_092229',
'20230717_092854',
'20230717_092947',
'20230717_093040',
'20230717_093121',
'20230717_093219',
'20230717_093243',
'20230717_093316',
'20230717_100214',
'20230717_100256',
'20230717_100403',
'20230717_100458',
'20230717_100614',
'20230717_100727',
'20230717_100808',
'20230717_101519',
'20230717_101554',
'20230717_101641',
'20230717_101739',
'20230717_101819',
'20230717_101927',
'20230717_102003',
'20230717_103743',
'20230717_103810',
'20230717_103847',
'20230717_103920',
'20230717_103950',
'20230717_104055',
'20230717_104123',
'20230717_104739',
'20230717_104807',
'20230717_104840',
'20230717_104916',
'20230717_104957',
'20230717_105125',
'20230717_105157',
'20230717_105235',
'20230718_074316',
'20230718_074407',
'20230718_074553',
'20230718_074743',
'20230718_074848',
'20230718_074909',
'20230718_074940',
'20230718_075738',
'20230718_075819',
'20230718_075906',
'20230718_080046',
'20230718_080152',
'20230718_080213',
'20230718_080244',
'20230718_080320',
'20230718_081631',
'20230718_081843',
'20230718_081939',
'20230718_082034',
'20230718_082145',
'20230718_082238',
'20230718_082319',
'20230718_083052',
'20230718_083150',
'20230718_083242',
'20230718_083338',
'20230718_083443',
'20230718_083506',
'20230718_083542',
'20230718_090610',
'20230718_090713',
'20230718_090838',
'20230718_090947',
'20230718_091030',
'20230718_091208',
'20230718_091308',
'20230718_100310',
'20230718_100405',
'20230718_100451',
'20230718_100540',
'20230718_100632',
'20230718_100759',
'20230718_100849',
'20230718_102148',
'20230718_102251',
'20230718_102413',
'20230718_102516',
'20230718_102657',
'20230718_102824',
'20230718_102911',
'20230718_103819',
'20230718_103903',
'20230718_104003',
'20230718_104044',
'20230718_104142',
'20230718_104303',
'20230718_104346',
'20230718_105129',
'20230720_013927',
'20230720_014025',
'20230720_014144',
'20230720_014249',
'20230720_014458',
'20230720_014522',
'20230720_014600',
'20230720_015329',
'20230720_015418',
'20230720_015514',
'20230720_015620',
'20230720_015735',
'20230720_015803',
'20230720_015854',
'20230720_015946',
'20230720_020725',
'20230720_020838',
'20230720_020939',
'20230720_021048',
'20230720_021209',
'20230720_021424',
'20230720_021510',
'20230720_022312',
'20230720_022402',
'20230720_022456',
'20230720_022603',
'20230720_022722',
'20230720_022744',
'20230720_022832',
'20230720_025941',
'20230720_030033',
'20230720_030123',
'20230720_030232',
'20230720_030341',
'20230720_030512',
'20230720_030618',
'20230720_030811',
'20230720_030857',
'20230720_030949',
'20230720_031107',
'20230720_031203',
'20230720_031326',
'20230720_031427',
'20230720_031510',
'20230721_023410',
'20230721_023518',
'20230721_023639',
'20230721_023735',
'20230721_023853',
'20230721_024222',
'20230721_024321',
'20230721_024442',
'20230721_024544',
'20230721_024718',
'20230721_024809',
'20230721_024918',
'20230721_025212',
'20230721_025302',
'20230721_030205',
'20230721_030255',
'20230721_030419',
'20230721_030530',
'20230721_030712',
'20230721_030745',
'20230721_030833',
'20230721_031815',
'20230721_031859',
'20230721_031953',
'20230721_032212',
'20230721_032330',
'20230721_032348',
'20230721_032424',
'20230721_034815',
'20230721_034858',
'20230721_034956',
'20230721_035058',
'20230721_035226',
'20230721_035250',
'20230721_035332',
'20230721_035943',
'20230721_040032',
'20230721_040118',
'20230721_040226',
'20230721_040341',
'20230721_040403',
'20230721_040447',
'20230721_040459',
'20230722_040222',
'20230722_040535',
'20230722_040642',
'20230722_040737',
'20230722_040836',
'20230722_040914',
'20230722_041042',
'20230722_041112',
'20230722_041205',
'20230722_041238',
'20230722_041333',
'20230722_041445',
'20230722_041513',
'20230722_041625',
'20230722_041652',
'20230722_042738',
'20230722_042812',
'20230722_042941',
'20230722_043034',
'20230722_043137',
'20230722_043205',
'20230722_043231',
'20230722_043715',
'20230722_043828',
'20230722_043856',
'20230722_043923',
'20230722_044011',
'20230722_044030',
'20230722_044052',
'20230722_045247',
'20230722_045302',
'20230722_045327',
'20230722_045432',
'20230722_045520',
'20230722_045536',
'20230722_045554',
'20230722_050041',
'20230722_050059',
'20230722_050123',
'20230722_050154',
'20230722_050243',
'20230722_050259',
'20230722_050321',
'20230723_012305',
'20230723_012400',
'20230723_012437',
'20230723_012533',
'20230723_012701',
'20230723_012720',
'20230723_012747',
'20230723_013431',
'20230723_013506',
'20230723_013540',
'20230723_013655',
'20230723_013709',
'20230723_013744',
'20230723_014415',
'20230723_014441',
'20230723_014522',
'20230723_014600',
'20230723_014723',
'20230723_014823',
'20230723_014908',
'20230723_014941',
'20230723_015543',
'20230723_015611',
'20230723_015644',
'20230723_015734',
'20230723_015842',
'20230723_015855',
'20230723_015928',
'20230723_021045',
'20230723_021127',
'20230723_021237',
'20230723_021340',
'20230723_021436',
'20230723_021555',
'20230723_021643',
'20230723_021841',
'20230723_021907',
'20230723_021936',
'20230723_022015',
'20230723_022128',
'20230723_022243',
'20230723_022323',
'20230724_014914',
'20230724_015006',
'20230724_015159',
'20230724_015247',
'20230724_015347',
'20230724_015404',
'20230724_015432',
'20230724_015502',
'20230724_020248',
'20230724_020337',
'20230724_020421',
'20230724_020514',
'20230724_020610',
'20230724_020627',
'20230724_020656',
'20230724_020802',
'20230724_021639',
'20230724_021748',
'20230724_021845',
'20230724_021943',
'20230724_022046',
'20230724_022140',
'20230724_022222',
'20230724_022909',
'20230724_022947',
'20230724_023021',
'20230724_023139',
'20230724_023235',
'20230724_023300',
'20230724_023332',
'20230724_025941',
'20230724_030037',
'20230724_030249',
'20230724_030325',
'20230724_030406',
'20230724_030520',
'20230724_030545',
'20230724_031358',
'20230724_031433',
'20230724_031509',
'20230724_031538',
'20230724_031611',
'20230724_031720',
'20230724_031745',
'20230724_033812',
'20230724_033915',
'20230724_034018',
'20230724_034047',
'20230724_034136',
'20230724_034237',
'20230724_034303',
'20230724_034943',
'20230724_035022',
'20230724_035122',
'20230724_035155',
'20230724_035222',
'20230724_035322',
'20230724_035358',
'20230724_035441',
'20230725_020007',
'20230725_020126',
'20230725_020230',
'20230725_020349',
'20230725_020543',
'20230725_020612',
'20230725_020708',
'20230725_021457',
'20230725_021633',
'20230725_021743',
'20230725_021901',
'20230725_022050',
'20230725_022118',
'20230725_022206',
'20230725_022303',
'20230725_023316',
'20230725_023456',
'20230725_023609',
'20230725_023739',
'20230725_023937',
'20230725_024000',
'20230725_024101',
'20230725_025057',
'20230725_025146',
'20230725_025240',
'20230725_025352',
'20230725_025536',
'20230725_025602',
'20230725_025658',
'20230725_032817',
'20230725_032913',
'20230725_033009',
'20230725_033102',
'20230725_033224',
'20230725_033434',
'20230725_033530',
'20230725_033744',
'20230725_033835',
'20230725_033923',
'20230725_034022',
'20230725_034245',
'20230725_034444',
'20230725_034549',
'20230727_014736',
'20230727_014845',
'20230727_014948',
'20230727_015059',
'20230727_015208',
'20230727_015234',
'20230727_015317',
'20230727_020059',
'20230727_020156',
'20230727_020255',
'20230727_020359',
'20230727_020516',
'20230727_020545',
'20230727_020647',
'20230727_020755',
'20230727_021714',
'20230727_021840',
'20230727_022040',
'20230727_022207',
'20230727_022331',
'20230727_022402',
'20230727_022447',
'20230727_023838',
'20230727_023918',
'20230727_024005',
'20230727_024056',
'20230727_024203',
'20230727_024220',
'20230727_024246',
'20230727_024324',
'20230727_030946',
'20230727_031036',
'20230727_031210',
'20230727_031300',
'20230727_031344',
'20230727_031542',
'20230727_031621',
'20230727_031802',
'20230727_031849',
'20230727_031958',
'20230727_032035',
'20230727_032239',
'20230727_032420',
'20230727_032501',
'20230728_071611',
'20230728_071656',
'20230728_071736',
'20230728_071833',
'20230728_072027',
'20230728_072044',
'20230728_072117',
'20230728_072646',
'20230728_072728',
'20230728_072802',
'20230728_072904',
'20230728_073023',
'20230728_073041',
'20230728_073112',
'20230728_073713',
'20230728_073801',
'20230728_073949',
'20230728_074533',
'20230728_074624',
'20230728_074740',
'20230728_074759',
'20230728_074824',
'20230728_075624',
'20230728_075700',
'20230728_075853',
'20230728_080026',
'20230728_080151',
'20230728_080238',
'20230728_080304',
'20230728_082335',
'20230728_082432',
'20230728_082621',
'20230728_082739',
'20230728_082824',
'20230728_083012',
'20230728_083110',
'20230728_083222',
'20230728_083256',
'20230728_083330',
'20230728_083429',
'20230728_083659',
'20230728_083823',
'20230728_083856',
'20230801_014954',
'20230801_015102',
'20230801_015156',
'20230801_015334',
'20230801_015412',
'20230801_015544',
'20230801_015624',
'20230801_020608',
'20230801_020651',
'20230801_020741',
'20230801_020811',
'20230801_020936',
'20230801_021050',
'20230801_021130',
'20230801_022103',
'20230801_022217',
'20230801_022511',
'20230801_022553',
'20230801_024531',
'20230801_024631',
'20230801_024826',
'20230801_024924',
'20230801_025025',
'20230801_025052',
'20230801_025132',
'20230801_025740',
'20230801_025826',
'20230801_025914',
'20230801_030011',
'20230801_030111',
'20230801_030146',
'20230801_030220',
'20230801_033245',
'20230801_033326',
'20230801_033412',
'20230801_033502',
'20230801_033608',
'20230801_033654',
'20230801_033734',
'20230801_034351',
'20230801_034434',
'20230801_034547',
'20230801_034643',
'20230801_034735',
'20230801_034804',
'20230801_034836',
'20230802_015423',
'20230802_015521',
'20230802_015619',
'20230802_015659',
'20230802_015757',
'20230802_020029',
'20230802_020105',
'20230802_021015',
'20230802_021149',
'20230802_021318',
'20230802_021423',
'20230802_021516',
'20230802_021706',
'20230802_021801',
'20230802_032902',
'20230802_032946',
'20230802_033038',
'20230802_033134',
'20230802_033303',
'20230802_033329',
'20230802_033407',
'20230802_034225',
'20230802_034306',
'20230802_034358',
'20230802_034454',
'20230802_034633',
'20230802_034716',
'20230802_034748',
'20230802_034812',
'20230802_035304',
'20230802_035351',
'20230802_035445',
'20230802_035556',
'20230802_035719',
'20230802_035745',
'20230802_035817',
'20230802_040456',
'20230802_040539',
'20230802_040625',
'20230802_040716',
'20230802_040836',
'20230802_040900',
'20230802_040938',
'20230803_020722',
'20230803_020901',
'20230803_021023',
'20230803_021131',
'20230803_021215',
'20230803_021353',
'20230803_021439',
'20230803_021556',
'20230803_021713',
'20230803_021815',
'20230803_021901',
'20230803_022107',
'20230803_022310',
'20230803_022343',
'20230803_023458',
'20230803_023554',
'20230803_023650',
'20230803_023809',
'20230803_024002',
'20230803_024029',
'20230803_024139',
'20230803_024947',
'20230803_025039',
'20230803_025132',
'20230803_025301',
'20230803_025509',
'20230803_025542',
'20230803_025651',
'20230803_032054',
'20230803_032138',
'20230803_032231',
'20230803_032405',
'20230803_032550',
'20230803_032611',
'20230803_032716',
'20230803_033630',
'20230803_033840',
'20230803_033930',
'20230803_034130',
'20230803_034322',
'20230803_034344',
'20230803_034453',
'20230803_034548',
'20230808_014813',
'20230808_015006',
'20230808_015201',
'20230808_015321',
'20230808_015541',
'20230808_015609',
'20230808_015655',
'20230808_023015',
'20230808_023219',
'20230808_023506',
'20230808_023623',
'20230808_023741',
'20230808_023811',
'20230808_023853',
'20230808_024645',
'20230808_024745',
'20230808_024845',
'20230808_024953',
'20230808_025127',
'20230808_025155',
'20230808_025242',
'20230808_031828',
'20230808_032026',
'20230808_032226',
'20230808_032324',
'20230808_032446',
'20230808_032656',
'20230808_032734',
'20230812_015300',
'20230812_015350',
'20230812_015445',
'20230812_015956',
'20230812_020106',
'20230812_020136',
'20230812_020213',
'20230812_021046',
'20230812_021135',
'20230812_021238',
'20230812_021340',
'20230812_021506',
'20230812_021537',
'20230812_021618',
'20230812_021704',
'20230812_022430',
'20230812_022610',
'20230812_022705',
'20230812_022805',
'20230812_022925',
'20230812_022950',
'20230812_023045',
'20230812_023717',
'20230812_023758',
'20230812_023845',
'20230812_023945',
'20230812_024115',
'20230812_024142',
'20230812_024221',
'20230812_030531',
'20230812_030708',
'20230812_030804',
'20230812_030900',
'20230812_030953',
'20230812_031223',
'20230812_031328',
'20230812_032307',
'20230812_032346',
'20230812_032436',
'20230812_032636',
'20230812_032719',
'20230812_032910',
'20230812_032951',
'20230812_035425',
'20230812_035512',
'20230812_035602',
'20230812_035645',
'20230812_035721',
'20230812_035900',
'20230812_035928',
'20230812_040734',
'20230812_040814',
'20230812_040903',
'20230812_040936',
'20230812_041025',
'20230812_041128',
'20230812_041209',
'20230812_041247',
'20230813_062409',
'20230813_062500',
'20230813_062630',
'20230813_062729',
'20230813_062835',
'20230813_062908',
'20230813_062943',
'20230813_063909',
'20230813_063951',
'20230813_064138',
'20230813_064238',
'20230813_064351',
'20230813_064420',
'20230813_064454',
'20230813_064603',
'20230813_065930',
'20230813_070039',
'20230813_070135',
'20230813_070232',
'20230813_070349',
'20230813_070421',
'20230813_070456',
'20230813_071140',
'20230813_071224',
'20230813_071305',
'20230813_071411',
'20230813_071518',
'20230813_071553',
'20230813_071633',
'20230813_073635',
'20230813_073719',
'20230813_073813',
'20230813_073903',
'20230813_074021',
'20230813_074135',
'20230813_074208',
'20230813_074810',
'20230813_074855',
'20230813_074933',
'20230813_075022',
'20230813_075123',
'20230813_075215',
'20230813_075259',
'20230813_081159',
'20230813_081238',
'20230813_081326',
'20230813_081409',
'20230813_081520',
'20230813_081605',
'20230813_082428',
'20230813_082505',
'20230813_082634',
'20230813_082728',
'20230813_082836',
'20230813_082907',
'20230813_082948',
'20230814_014403',
'20230814_014500',
'20230814_014556',
'20230814_014814',
'20230814_015106',
'20230814_015141',
'20230814_015218',
'20230814_020111',
'20230814_020202',
'20230814_020318',
'20230814_020416',
'20230814_020530',
'20230814_020555',
'20230814_020725',
'20230814_021136',
'20230814_021216',
'20230814_021257',
'20230814_021356',
'20230814_021513',
'20230814_021535',
'20230814_021623',
'20230814_022301',
'20230814_022343',
'20230814_022427',
'20230814_022520',
'20230814_022652',
'20230814_022729',
'20230814_022824',
'20230814_023818',
'20230814_025816',
'20230814_025900',
'20230814_025948',
'20230814_030028',
'20230814_030105',
'20230814_030217',
'20230814_030259',
'20230814_030947',
'20230814_031025',
'20230814_031106',
'20230814_031149',
'20230814_031320',
'20230814_031426',
'20230814_031514',
'20230814_034011',
'20230814_034048',
'20230814_034201',
'20230814_034238',
'20230814_034322',
'20230814_034435',
'20230814_034502',
'20230814_035249',
'20230814_035325',
'20230814_035417',
'20230814_035446',
'20230814_035538',
'20230814_035833',
'20230814_035859',
'20230817_015350',
'20230817_015520',
'20230817_015618',
'20230817_015740',
'20230817_015919',
'20230817_015948',
'20230817_020027',
'20230817_020939',
'20230817_021222',
'20230817_021301',
'20230817_021354',
'20230817_021507',
'20230817_021531',
'20230817_021604',
'20230817_021651',
'20230817_023111',
'20230817_023306',
'20230817_023409',
'20230817_023503',
'20230817_023613',
'20230817_023641',
'20230817_023711',
'20230817_024447',
'20230817_024538',
'20230817_024628',
'20230817_024740',
'20230817_024849',
'20230817_024912',
'20230817_024948',
'20230817_031237',
'20230817_031326',
'20230817_031423',
'20230817_031519',
'20230817_031616',
'20230817_031646',
'20230817_031717',
'20230817_032303',
'20230817_032342',
'20230817_032427',
'20230817_032508',
'20230817_032601',
'20230817_032626',
'20230817_032652',
'20230817_034206',
'20230817_034245',
'20230817_034326',
'20230817_034409',
'20230817_034511',
'20230817_034532',
'20230817_034610',
'20230817_035155',
'20230817_035229',
'20230817_035315',
'20230817_035405',
'20230817_035507',
'20230817_035528',
'20230817_035559',
'20230817_035615',
'20230825_010053',
'20230825_013916',
'20230825_014237',
'20230825_014423',
'20230825_014737',
'20230825_014843',
'20230825_015047',
'20230825_015128',
'20230825_015221',
'20230825_015303',
'20230825_015402',
'20230825_015445',
'20230825_015610',
'20230825_015731',
'20230825_015835',
'20230825_021225',
'20230825_021259',
'20230825_021400',
'20230825_021447',
'20230825_021630',
'20230825_021651',
'20230825_021717',
'20230825_022153',
'20230825_022219',
'20230825_022247',
'20230825_022333',
'20230825_022424',
'20230825_022441',
'20230825_022504',
'20230825_022617',
'20230825_022658',
'20230825_022759',
'20230825_023018',
'20230825_023057',
'20230825_023319',
'20230825_023343',
'20230825_023405',
'20230825_023824',
'20230825_023848',
'20230825_023924',
'20230825_023959',
'20230825_024049',
'20230825_024107',
'20230825_024129'
]



# Function to calculate the distance between two bounding boxes
def bbox_distance(bbox1, bbox2):
	x1, y1, w1, h1 = bbox1
	x2, y2, w2, h2 = bbox2
	center1_x = x1 + w1 / 2
	center1_y = y1 + h1 / 2
	center2_x = x2 + w2 / 2
	center2_y = y2 + h2 / 2
	distance = ((center1_x - center2_x) ** 2 + (center1_y - center2_y) ** 2) ** 0.5
	return distance


belt_txt = open('/data/data/pms/OD/belt_err_0918.txt', 'w')
multi_obj = open('/data/data/pms/OD/obj_err_0918.txt', 'w')
for j_file in tqdm(glob('/nas/data/2023PMS/ㅁㅁ/**/*.json',recursive=True)):
	file_name = j_file.split('/')[-3]+'.json'
	err = False
	# 1-person, 2-face, 3-eyes, 4-cigar, 5-phone, 6-mask, 7-bottle, 8-dog, 9-belt
	# Group annotations by (image_id, category_id)
	grouped_annotations = {}

	with open(j_file) as json_file:
		json_data = json.load(json_file)
		for images in json_data['images']:
			belt_bool = True

			if '/' in images['file_name']:
				if images['file_name'].split('/')[1] in no_belt:
					belt_bool = False
			elif '-' in images['file_name']:
				if images['file_name'].split('-')[1] in no_belt:
					belt_bool = False

			for idx, ann in enumerate(json_data['annotations']):
				if belt_bool is False and ann['category_id'] == 9 and images['id'] == ann['image_id']:
					belt_txt.write(f'{file_name} : {ann["image_id"]}\n')
					err= True

		for ann in json_data['annotations']:
			image_id = ann['image_id']
			category_id = ann['category_id']
			key = (image_id, category_id)

			if key not in grouped_annotations:
				grouped_annotations[key] = []

			grouped_annotations[key].append(ann)

		# Create a new list to store filtered annotations
		new_annotations = []

		# Iterate through each group of annotations
		for group_key, group_anns in grouped_annotations.items():
			if len(group_anns) < 2:
				new_annotations.extend(group_anns)
				continue

			if group_key[1] in [1,2,3,9]:
				if len(group_anns)>2:
					err=True
					multi_obj.write(f'{file_name} : {group_key[0]}\n')
	if err is False:
		shutil.move(j_file, f'/nas/data/2023PMS/od_검수완료/{file_name}')
	else:
		shutil.move(j_file, f'/nas/data/2023PMS/od_err/{file_name}')
multi_obj.close()
belt_txt.close()
				# leftmost = None
				# rightmost = None
				# min_x = float('inf')
				# max_x = float('-inf')
				#
				# for ann in group_anns:
				# 	x, _, _, _ = ann['bbox']
				# 	if x < min_x:
				# 		min_x = x
				# 		leftmost = ann
				# 	if x > max_x:
				# 		max_x = x
				# 		rightmost = ann
				#
				# new_annotations.append(leftmost)
				# new_annotations.append(rightmost)
			# else:
			# 	to_remove = set()
			# 	for i, j in combinations(range(len(group_anns)), 2):
			# 		ann1 = group_anns[i]
			# 		ann2 = group_anns[j]
			#
			# 		bbox1 = ann1['bbox']
			# 		bbox2 = ann2['bbox']
			#
			# 		distance = bbox_distance(bbox1, bbox2)
			#
			# 		if distance <= 3:
			# 			to_remove.add(j)  # Remove the second annotation
#
# 				# Add remaining annotations to the new list
# 				for i, ann in enumerate(group_anns):
# 					if i not in to_remove:
# 						new_annotations.append(ann)
#
# # Update the annotations in the COCO data
# json_data['annotations'] = new_annotations
#
# with open(f'/data/aa/change_json/{file_name}', 'w', encoding='utf-8') as new_json:
# 	json.dump(json_data, new_json, ensure_ascii=False, indent=2)



# import os
# from glob import glob
# from tqdm import tqdm
# import shutil
# import pandas as pd

# for i in tqdm(glob('/data/save_900/**/*.txt',recursive=True)):
# 	if os.stat(i).st_size < 200:
# 		print(i)


# df = pd.read_csv('/nas/data/2023PMS/기타/file_list/od_lst.csv')
# for i in tqdm(glob('/nas/data/2023PMS/3차(1차 보강+2차 보강)/FS_프레임추출/FileList_2차_추가/ObjectDetections_03/**/*.png',recursive=True)):
# 	file_name = '-'.join(i.split('/')[-3:])
# 	if file_name in df['file_name'].tolist():
# 		print('중복파일 : ', file_name)
# 	# print(i.split("/")[8:10])
# 	# break
# 	try:
# 		os.makedirs(f'/nas/data/2023PMS/3차(1차 보강+2차 보강)/od_edit/{"/".join(i.split("/")[8:10])}', exist_ok=True)
# 		shutil.copy(i, f'/nas/data/2023PMS/3차(1차 보강+2차 보강)/od_edit/{"/".join(i.split("/")[8:10])}/{i.split("/")[-1]}')
# 	except IsADirectoryError as e:
# 		continue
# 	except Exception as e:
# 		print(e)
# 		print(i)
# 		break